<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>spark.spec-tacular documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Spec-tacular 0.5.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spark</span></div></div></li><li class="depth-2 current"><a href="spark.spec-tacular.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec-tacular</span></div></a></li><li class="depth-3 branch"><a href="spark.spec-tacular.datomic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datomic</span></div></a></li><li class="depth-3"><a href="spark.spec-tacular.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="spark.spec-tacular.html#var-check-component.21"><div class="inner"><span>check-component!</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-database-coercion"><div class="inner"><span>database-coercion</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-defspec"><div class="inner"><span>defspec</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-defunion"><div class="inner"><span>defunion</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-diff"><div class="inner"><span>diff</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-get-spec"><div class="inner"><span>get-spec</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-get-type"><div class="inner"><span>get-type</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-has-spec.3F"><div class="inner"><span>has-spec?</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-identical-keys"><div class="inner"><span>identical-keys</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-Item"><div class="inner"><span>Item</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-namespace-.3Especs"><div class="inner"><span>namespace-&gt;specs</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-primitive.3F"><div class="inner"><span>primitive?</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-recursiveness"><div class="inner"><span>recursiveness</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-refless"><div class="inner"><span>refless</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-refless.3D"><div class="inner"><span>refless=</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-SpecInstance"><div class="inner"><span>SpecInstance</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-SpecName"><div class="inner"><span>SpecName</span></div></a></li><li class="depth-1"><a href="spark.spec-tacular.html#var-SpecT"><div class="inner"><span>SpecT</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">spark.spec-tacular</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-check-component.21"><h3>check-component!</h3><div class="usage"><code>(check-component! spec k v)</code></div><div class="doc"><div class="markdown"><p>Checks the field name <code>k</code> and its value <code>v</code> against the given spec, errors if <code>v</code> is not of the correct type.</p></div></div></div><div class="public anchor" id="var-database-coercion"><h3>database-coercion</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Returns the coercion function that maps an object of a known database type (currently <code>datomic.query.EntityMap</code>) to a map that can be used in a spec constructor. Defaults to <code>nil</code> if the object does not come from a known database type.</p></div></div></div><div class="public anchor" id="var-defspec"><h3>defspec</h3><h4 class="type">macro</h4><div class="usage"><code>(defspec &amp; stx)</code></div><div class="doc"><div class="markdown"><p>Defines a spec-tacular spec type.</p>
<pre><code>(defspec Name
  [field-name arity type option ...]
  ...)
</code></pre><p>creates the spec <code>:Name</code>; where arity is either <code>:is-a</code> or <code>:is-many</code>, type is either another spec name or a primitive type keyword, and option is any of <code>:unique</code>, <code>:identity</code>, <code>:link</code>, or <code>:required</code>.</p><p>spec-tacular supports base types <code>:keyword</code>, <code>:string</code>, <code>:boolean</code>, <code>:long</code>, <code>:bigint</code>, <code>:float</code>, <code>:double</code>, <code>:bigdec</code>, <code>:instant</code>, <code>:calendarday</code>, <code>:uuid</code>, <code>:uri</code>, and <code>:bytes</code>.</p><p>A core.typed alias <code>Name</code> is created, as well as a constructor <code>name</code> and a predicate <code>name?</code>.</p><p>Spec instances that are created from a database may also contain the <code>:db-ref</code> field which, in the case of Datomic, contains a map <code>{:eid
database-id}</code> containing the entity&rsquo;s <code>:db/id</code>.</p></div></div></div><div class="public anchor" id="var-defunion"><h3>defunion</h3><h4 class="type">macro</h4><div class="usage"><code>(defunion &amp; stx)</code></div><div class="doc"><div class="markdown"><p>Defines a spec-tacular union.</p>
<pre><code>(defunion Name :SpecName ...)
</code></pre><p>where each SpecName is another spec to be added to the union.</p></div></div></div><div class="public anchor" id="var-diff"><h3>diff</h3><div class="usage"><code>(diff sp1 sp2)</code></div><div class="doc"><div class="markdown"><p>Takes two spec instances and returns a vector of three maps created by calling <code>clojure.data/diff</code> on each item of the spec.</p><p>Only well defined when sp1 and sp2 share the same spec.</p><p>For <code>:is-many</code> fields, expect to see sets of similarities or differences in the result, as order should not matter.</p></div></div></div><div class="public anchor" id="var-get-spec"><h3>get-spec</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>If the given object is a spec or union, or was defined by <a href="spark.spec-tacular.html#var-defspec">defspec</a> or <a href="spark.spec-tacular.html#var-defunion">defunion</a>, returns that spec or union, otherwise <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-get-type"><h3>get-type</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Returns a SpecType record containing the <code>name</code> of the type, the class <code>type</code>, a symbol <code>type-symbol</code> that would eval to the <code>type</code> (useful for macros), and possibly a <code>coercion</code> function.</p></div></div></div><div class="public anchor" id="var-has-spec.3F"><h3>has-spec?</h3><div class="usage"><code>(has-spec? o)</code></div><div class="doc"><div class="markdown"><p>Returns whether or not the given object has a spec.</p></div></div></div><div class="public anchor" id="var-identical-keys"><h3>identical-keys</h3><div class="usage"><code>(identical-keys si)</code></div><div class="doc"><div class="markdown"><p>Takes any number of spec instances and returns the keys for fields with values they all share in common. Useful for error messages.</p></div></div></div><div class="public anchor" id="var-Item"><h3>Item</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The type of a field in a spec</p><p>&lsquo;{:name t/Keyword, :type &rsquo;[(t/U (t/Val :one) (t/Val :many)) SpecName]}</p></div></div></div><div class="public anchor" id="var-namespace-.3Especs"><h3>namespace-&gt;specs</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Returns a sequence containing every spec in the given namespace.</p></div></div></div><div class="public anchor" id="var-primitive.3F"><h3>primitive?</h3><div class="usage"><code>(primitive? spec-name)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> if the given spec name is primitive (i.e. is part of the base type environment and not defined as a spec), <code>false</code> otherwise. See <a href="spark.spec-tacular.html#var-defspec">defspec</a> for a list of primitive type keywords.</p></div></div></div><div class="public anchor" id="var-recursiveness"><h3>recursiveness</h3><div class="usage"><code>(recursiveness {[_ t] :type})</code></div><div class="doc"><div class="markdown"><p>Returns <code>:non-rec</code> if the given item is <a href="spark.spec-tacular.html#var-primitive.3F">primitive?</a>, <code>:rec</code> otherwise.</p></div></div></div><div class="public anchor" id="var-refless"><h3>refless</h3><div class="usage"><code>(refless si)</code></div><div class="doc"><div class="markdown"><p>Returns a version of the given spec instance with no <code>:db-ref</code>s on any sub-instance.</p></div></div></div><div class="public anchor" id="var-refless.3D"><h3>refless=</h3><div class="usage"><code>(refless= x y)</code></div><div class="doc"><div class="markdown"><p>Given any walkable collection, returns <code>true</code> if the two collections would be <code>=</code> if no spec instances had <code>:db-ref</code>s.</p><p>Contains a fast path if both <code>x</code> and <code>y</code> have specs, otherwise expect bad asymptotics as each collection must be rebuilt without <code>:db-ref</code>s.</p></div></div></div><div class="public anchor" id="var-SpecInstance"><h3>SpecInstance</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The broadest type for a spec instance, but it is  preferable to use an alias defined via <a href="spark.spec-tacular.html#var-defspec">defspec</a>.</p><p>(t/Map t/Keyword t/Any)</p></div></div></div><div class="public anchor" id="var-SpecName"><h3>SpecName</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The type of the <code>:name</code> field of a spec</p><p>t/Keyword</p></div></div></div><div class="public anchor" id="var-SpecT"><h3>SpecT</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The type of a spec</p><p>(t/HMap  :mandatory  {:name SpecName}  :optional  {:elements (t/Seqable SpecName), :items (t/Seqable Item)})</p></div></div></div></div></body></html>